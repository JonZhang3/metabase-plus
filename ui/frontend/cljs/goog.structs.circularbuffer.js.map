{
"version":3,
"file":"goog.structs.circularbuffer.js",
"lineCount":78,
"mappings":"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",
"sources":["goog/structs/circularbuffer.js"],
"sourcesContent":["// Copyright 2006 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/**\n * @fileoverview Datastructure: Circular Buffer.\n *\n * Implements a buffer with a maximum size. New entries override the oldest\n * entries when the maximum size has been reached.\n *\n */\n\n\ngoog.provide('goog.structs.CircularBuffer');\n\n\n\n/**\n * Class for CircularBuffer.\n * @param {number=} opt_maxSize The maximum size of the buffer.\n * @constructor\n * @template T\n */\ngoog.structs.CircularBuffer = function(opt_maxSize) {\n  /**\n   * Index of the next element in the circular array structure.\n   * @private {number}\n   */\n  this.nextPtr_ = 0;\n\n  /**\n   * Maximum size of the the circular array structure.\n   * @private {number}\n   */\n  this.maxSize_ = opt_maxSize || 100;\n\n  /**\n   * Underlying array for the CircularBuffer.\n   * @private {!Array<T>}\n   */\n  this.buff_ = [];\n};\n\n\n/**\n * Adds an item to the buffer. May remove the oldest item if the buffer is at\n * max size.\n * @param {T} item The item to add.\n * @return {T|undefined} The removed old item, if the buffer is at max size.\n *     Return undefined, otherwise.\n */\ngoog.structs.CircularBuffer.prototype.add = function(item) {\n  const previousItem = this.buff_[this.nextPtr_];\n  this.buff_[this.nextPtr_] = item;\n  this.nextPtr_ = (this.nextPtr_ + 1) % this.maxSize_;\n  return previousItem;\n};\n\n\n/**\n * Returns the item at the specified index.\n * @param {number} index The index of the item. The index of an item can change\n *     after calls to `add()` if the buffer is at maximum size.\n * @return {T} The item at the specified index.\n */\ngoog.structs.CircularBuffer.prototype.get = function(index) {\n  index = this.normalizeIndex_(index);\n  return this.buff_[index];\n};\n\n\n/**\n * Sets the item at the specified index.\n * @param {number} index The index of the item. The index of an item can change\n *     after calls to `add()` if the buffer is at maximum size.\n * @param {T} item The item to add.\n */\ngoog.structs.CircularBuffer.prototype.set = function(index, item) {\n  index = this.normalizeIndex_(index);\n  this.buff_[index] = item;\n};\n\n\n/**\n * Returns the current number of items in the buffer.\n * @return {number} The current number of items in the buffer.\n */\ngoog.structs.CircularBuffer.prototype.getCount = function() {\n  return this.buff_.length;\n};\n\n\n/**\n * @return {boolean} Whether the buffer is empty.\n */\ngoog.structs.CircularBuffer.prototype.isEmpty = function() {\n  return this.buff_.length == 0;\n};\n\n\n/**\n * Empties the current buffer.\n */\ngoog.structs.CircularBuffer.prototype.clear = function() {\n  this.buff_.length = 0;\n  this.nextPtr_ = 0;\n};\n\n\n/**\n * @return {!Array<T>} The values in the buffer ordered from oldest to newest.\n */\ngoog.structs.CircularBuffer.prototype.getValues = function() {\n  // getNewestValues returns all the values if the maxCount parameter is the\n  // count\n  return this.getNewestValues(this.getCount());\n};\n\n\n/**\n * Returns the newest values in the buffer up to `count`.\n * @param {number} maxCount The maximum number of values to get. Should be a\n *     positive number.\n * @return {!Array<T>} The newest values in the buffer up to `count`. The\n *     values are ordered from oldest to newest.\n */\ngoog.structs.CircularBuffer.prototype.getNewestValues = function(maxCount) {\n  const l = this.getCount();\n  const start = this.getCount() - maxCount;\n  const rv = [];\n  for (let i = start; i < l; i++) {\n    rv.push(this.get(i));\n  }\n  return rv;\n};\n\n\n/** @return {!Array<number>} The indexes in the buffer. */\ngoog.structs.CircularBuffer.prototype.getKeys = function() {\n  const rv = [];\n  const l = this.getCount();\n  for (let i = 0; i < l; i++) {\n    rv[i] = i;\n  }\n  return rv;\n};\n\n\n/**\n * Whether the buffer contains the key/index.\n * @param {number} key The key/index to check for.\n * @return {boolean} Whether the buffer contains the key/index.\n */\ngoog.structs.CircularBuffer.prototype.containsKey = function(key) {\n  return key < this.getCount();\n};\n\n\n/**\n * Whether the buffer contains the given value.\n * @param {T} value The value to check for.\n * @return {boolean} Whether the buffer contains the given value.\n */\ngoog.structs.CircularBuffer.prototype.containsValue = function(value) {\n  const l = this.getCount();\n  for (let i = 0; i < l; i++) {\n    if (this.get(i) == value) {\n      return true;\n    }\n  }\n  return false;\n};\n\n\n/**\n * Returns the last item inserted into the buffer.\n * @return {T|null} The last item inserted into the buffer,\n *     or null if the buffer is empty.\n */\ngoog.structs.CircularBuffer.prototype.getLast = function() {\n  if (this.getCount() == 0) {\n    return null;\n  }\n  return this.get(this.getCount() - 1);\n};\n\n\n/**\n * Helper function to convert an index in the number space of oldest to\n * newest items in the array to the position that the element will be at in the\n * underlying array.\n * @param {number} index The index of the item in a list ordered from oldest to\n *     newest.\n * @return {number} The index of the item in the CircularBuffer's underlying\n *     array.\n * @private\n */\ngoog.structs.CircularBuffer.prototype.normalizeIndex_ = function(index) {\n  if (index >= this.buff_.length) {\n    throw new Error('Out of bounds exception');\n  }\n\n  if (this.buff_.length < this.maxSize_) {\n    return index;\n  }\n\n  return (this.nextPtr_ + Number(index)) % this.maxSize_;\n};\n"],
"names":["goog","provide","structs","CircularBuffer","goog.structs.CircularBuffer","opt_maxSize","nextPtr_","maxSize_","buff_","prototype","add","goog.structs.CircularBuffer.prototype.add","item","previousItem","get","goog.structs.CircularBuffer.prototype.get","index","normalizeIndex_","set","goog.structs.CircularBuffer.prototype.set","getCount","goog.structs.CircularBuffer.prototype.getCount","length","isEmpty","goog.structs.CircularBuffer.prototype.isEmpty","clear","goog.structs.CircularBuffer.prototype.clear","getValues","goog.structs.CircularBuffer.prototype.getValues","getNewestValues","goog.structs.CircularBuffer.prototype.getNewestValues","maxCount","l","start","rv","i","push","getKeys","goog.structs.CircularBuffer.prototype.getKeys","containsKey","goog.structs.CircularBuffer.prototype.containsKey","key","containsValue","goog.structs.CircularBuffer.prototype.containsValue","value","getLast","goog.structs.CircularBuffer.prototype.getLast","goog.structs.CircularBuffer.prototype.normalizeIndex_","Error","Number"]
}
